(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2218:(e,r,t)=>{"use strict";t.d(r,{AppProvider:()=>d});var l=t(4568),s=t(7620),n=t(1981),a=t(4869),u=t(6640),o=t(7156),c=t(2151);let i=new n.E({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:1},mutations:{retry:1}}}),h=()=>{let{initalized:e}=(0,u.h)();return(0,s.useEffect)(()=>{(0,o.ES)()},[]),null},d=e=>{let{children:r}=e;return(0,l.jsxs)(a.Ht,{client:i,children:[(0,l.jsx)(h,{}),(0,l.jsx)(c.ph,{}),r]})}},5214:(e,r,t)=>{"use strict";t.d(r,{Z:()=>n});var l=t(7156),s=t(7248);let n={register:e=>(0,l.bE)(s.Sn.AUTH_REGISTER,e),login:e=>(0,l.bE)(s.Sn.AUTH_LOGIN,e),getCurrentUser:()=>(0,l.Jt)(s.Sn.AUTH_ME),changePassword:e=>(0,l.F6)(s.Sn.AUTH_CHANGE_PASSWORD,e)}},6640:(e,r,t)=>{"use strict";t.d(r,{h:()=>c});var l=t(7620);let s=(0,t(1367).vt)(e=>({user:null,isLoading:!1,isAuthenticated:!1,setUser:r=>e({user:r,isAuthenticated:!!r}),setLoading:r=>e({isLoading:r}),login:r=>e({user:r,isAuthenticated:!0}),logout:()=>e({user:null,isAuthenticated:!1})}));var n=t(5214),a=t(7156),u=t(7248),o=t(796);function c(e){var r;let{user:t,isLoading:c,isAuthenticated:i,logout:h,setUser:d,setLoading:E}=s(),[g,v]=(0,l.useState)(!1);(0,l.useEffect)(()=>{(async()=>{try{let e=localStorage.getItem(u.il);if(e){(0,a.O5)(e);let r=await n.Z.getCurrentUser();d(r)}}catch(e){(0,a.Tp)(),localStorage.removeItem(u.il)}finally{v(!0)}})()},[d]);let f=(0,l.useCallback)(async(r,t)=>{try{E(!0);let e=await n.Z.login({email:r,password:t});localStorage.setItem(u.il,e.accessToken),(0,a.O5)(e.accessToken);let{accessToken:l,...s}=e;return d(s),{success:!0}}catch(r){var l;return null==e||null==(l=e.onAuthError)||l.call(e,r),{success:!1,error:(0,o.u1)(r)}}finally{E(!1)}},[E,d,e]),m=(0,l.useCallback)(()=>{localStorage.removeItem(u.il),(0,a.Tp)(),h()},[h]),A=(0,l.useCallback)(async(r,t,l,s)=>{try{E(!0);let e=await n.Z.register({email:r,password:t,confirmPassword:t,firstName:l,lastName:s});localStorage.setItem(u.il,e.accessToken),(0,a.O5)(e.accessToken);let{accessToken:o,...c}=e;return d(c),{success:!0}}catch(r){var c;return null==e||null==(c=e.onAuthError)||c.call(e,r),{success:!1,error:(0,o.u1)(r)}}finally{E(!1)}},[E,d,e]),S=(0,l.useCallback)(e=>!0,[]),T=(null==t||null==(r=t.subscription)?void 0:r.plan)==="pro";return(0,l.useEffect)(()=>{let r=()=>{var r;m(),null==e||null==(r=e.onAuthError)||r.call(e,Error("Unauthorized"))};return window.addEventListener("auth-error",r),()=>window.removeEventListener("auth-error",r)},[m,e]),{user:t,isLoading:c,isAuthenticated:i,initalized:g,isPro:T,login:f,logout:m,register:A,hasPermission:S}}},7924:(e,r,t)=>{Promise.resolve().then(t.bind(t,2218)),Promise.resolve().then(t.t.bind(t,8761,23))},8761:()=>{}},e=>{e.O(0,[950,517,662,226,982,587,18,358],()=>e(e.s=7924)),_N_E=e.O()}]);